## 七日之书：量身打造angular开发解决方案(1)

> 不知不觉，我们团队实践`AngularJS`已经一年多了， 老实说，`AngularJS`很多坑，我们希望能总结出来，对后来人能有所帮助。

> 最近在反复拜读 @fouber 的 [「前端工程系列文章」](https://github.com/fouber/blog)， 发现神器[FIS](http://fis.baidu.com/)，于是希望能借此机会，量身打造一款Angular前端工具。


### Day1: 2014年11月11日 - 手仍在

首先是``需求调研``，根据团队的实践和社区的调研，它应该具备：

1. 模块化开发。最好能像写nodejs一样写js，很舒服。
2. 性能要好。模块那么多，得能按需加载，请求不能多。还要能支持`ngRoute`和`ui-router`。
3. 组件化开发，官方不是提倡`organize by feature`么？就这么整吧！一个组件的js、css、模板最好都在一个目录维护，维护起来方便。
4. 也许哪天我就不爱你了呢？ 所以不能对`angular`进行太耦合的hack，要原汁原味。
5. `CoffeeScript`,`Sass`之类的有意思，也给我来一个。
6. 图片base64嵌入。有些小图可能要以base64的形式嵌入到页面、js或者css中使用。嵌入之前记得压缩图片以减小体积。
7. js/css/图片压缩应该都没问题吧。
8. 测试不能停，要能与ci平台集成， 支持`karma`和`protractor`。
9. 开发体验要好。文件监听，浏览器自动刷新(livereload)一个都不能少。
10. 我们用nodejs作为服务器，本地要能预览，最好再能抓取线上数据，方便调试。
11. 业界那么多优秀类库， 当然要支持`bower`组件仓库的安装啦。
12. `yeoman`用过吧？ 对， `脚手架`功能也不能少了。
13. 依赖注入声明的写法太烦了，参考下`ng-annotate`吧。
14. 顺便再提供个打包功能吧

回头看看这个列表，我怎么有点腿发软了。。。

---
好吧，在瓶神的鼓励下， 我们试试看吧，先把上面的需求整理下：

- 规范
  - 开发规范
    - 模块化开发，js模块化，css模块化，像nodejs一样编码
    - 组件化开发，js、css、tpl维护在一起，`organize by feature`
    - 按需加载，支持`ngRoute`和`ui-router`
    - 尽量原生化的编写Angular
  - 部署规范
    - 采用nodejs后端，基本部署规范应该参考`express`项目部署
    - 按版本号做非覆盖式发布
    - 公共模块可发布给第三方共享

- 框架
  - js模块化框架，支持请求合并，按需加载等性能优化点

- 工具
  - 支持`ng-annotate`自动生成`angular`的依赖注入声明。
  - 可以`CoffeeScript`,`Sass`的编译
  - 支持js、css、图片压缩
  - 允许图片压缩后以base64编码形式嵌入到css、js或html中
  - 与ci平台集成， 支持`karma`单元测试, `protractor`端到端测试。
  - 文件监听、浏览器自动刷新
  - 本地预览、数据模拟
  - 提供类似yo的脚手架, 生成项目框架，包括Controller等
  - 提供打包功能

- 仓库
  - 支持bower模块安装和使用


